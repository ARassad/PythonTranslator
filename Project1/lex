%{
#include <stdio.h>
#include <stdlib.h>
%}
%option noyywrap
%option never-interactive
%x ONECOMMENT
%x STRING
%x COMMENT
%x CCOMMENT
%%

%{
	int indexTop = 0;
	int indentStack[1000];
	indentStack[0] = 0;
	char buffer[1000];
%}

^[ ]+		{
				int len = strlen(yytext);
				if( len > indentStack[indexTop] )
				{
					indexTop++;
					indentStack[indexTop] = len;
					printf("INDENT : %d\n", len);
				}
				else if( len < indentStack[indexTop])
				{
					while(len < indentStack[indexTop])
						indexTop--;
						
					if (len != indentStack[indexTop])
						printf("Error: inconsistent dedent %d\n", len);
					else
						printf("DEDENT : %d\n", len);
				}		
			}
\"				{BEGIN(STRING);buffer[0] = 0;}
<STRING>\\n		strcat(buffer,"\n");
<STRING>\\\"	strcat(buffer,"\"");
<STRING>\\\\	strcat(buffer,"\\");
<STRING>\\\'	strcat(buffer,"\'");
<STRING>\'		strcat(buffer,"\'");
<STRING>\\newline
<STRING>\\a		strcat(buffer,"\a");
<STRING>\\b		strcat(buffer,"\b");
<STRING>\\f		strcat(buffer,"\f");
<STRING>\\r		strcat(buffer,"\r");
<STRING>\\t		strcat(buffer,"\t");
<STRING>\\v		strcat(buffer,"\v");
<STRING>[^\"\\\n\'\a\b\f\r\t\v]+		strcat(buffer,yytext);
<STRING>\" 		{printf("String literal %s\n",buffer); BEGIN(INITIAL);}
#			{BEGIN(ONECOMMENT);}
<ONECOMMENT>[^\/\n]
<ONECOMMENT>[\/\n]	{BEGIN(INITIAL);}
\"\"\"			{BEGIN(COMMENT);}
<COMMENT>[^\"{3}] 
<COMMENT>\"{3}	{BEGIN(INITIAL);}
\'{3}		{BEGIN(CCOMMENT);}
<CCOMMENT>[^\'{3}]
<CCOMMENT>\'{3}	{BEGIN(INITIAL);}
False    	printf("Keyword : %s\n", yytext);
if     	 	printf("Keyword : %s\n", yytext);
import     	printf("Keyword : %s\n", yytext);
from     	printf("Keyword : %s\n", yytext);
in     		printf("Keyword : %s\n", yytext);
is     		printf("Keyword : %s\n", yytext);
as     		printf("Keyword : %s\n", yytext);
lambda     	printf("Keyword : %s\n", yytext);
not     	printf("Keyword : %s\n", yytext);
or     		printf("Keyword : %s\n", yytext);
pass     	printf("Keyword : %s\n", yytext);
raise     	printf("Keyword : %s\n", yytext);
return     	printf("Keyword : %s\n", yytext);
try     	printf("Keyword : %s\n", yytext);
while     	printf("Keyword : %s\n", yytext);
with     	printf("Keyword : %s\n", yytext);
None     	printf("Keyword : %s\n", yytext);
True     	printf("Keyword : %s\n", yytext);
and     	printf("Keyword : %s\n", yytext);
assert     	printf("Keyword : %s\n", yytext);
break     	printf("Keyword : %s\n", yytext);
class     	printf("Keyword : %s\n", yytext);
continue    printf("Keyword : %s\n", yytext);
def     	printf("Keyword : %s\n", yytext);
elif     	printf("Keyword : %s\n", yytext);
else     	printf("Keyword : %s\n", yytext);
except     	printf("Keyword : %s\n", yytext);
finally     printf("Keyword : %s\n", yytext);
\+    		printf("Oper : %s\n", yytext);
-     		printf("Oper : %s\n", yytext);
\*     		printf("Oper : %s\n", yytext);
\*\*     	printf("Oper : %s\n", yytext);
\/     		printf("Oper : %s\n", yytext);
\/\/     	printf("Oper : %s\n", yytext);
\%    		printf("Oper : %s\n", yytext);
@     		printf("Oper : %s\n", yytext);
\<\<     	printf("Oper : %s\n", yytext);
>>     		printf("Oper : %s\n", yytext);
&     		printf("Oper : %s\n", yytext);
\|     		printf("Oper : %s\n", yytext);
\^    		printf("Oper : %s\n", yytext);
~     		printf("Oper : %s\n", yytext);
>     		printf("Oper : %s\n", yytext);
\<     		printf("Oper : %s\n", yytext);
\<=     	printf("Oper : %s\n", yytext);
\>=     	printf("Oper : %s\n", yytext);
==    		printf("Oper : %s\n", yytext);
!=     		printf("Oper : %s\n", yytext);
\(     		printf("Oper : %s\n", yytext);
\)     		printf("Oper : %s\n", yytext);
\[     		printf("Oper : %s\n", yytext);
\]     		printf("Oper : %s\n", yytext);
\{    		printf("Oper : %s\n", yytext);
\}     		printf("Oper : %s\n", yytext);
,     		printf("Oper : %s\n", yytext);
:     		printf("Oper : %s\n", yytext);
\.     		printf("Oper : %s\n", yytext);
\;     		printf("Oper : %s\n", yytext);
\=    		printf("Oper : %s\n", yytext);
->     		printf("Oper : %s\n", yytext);
\+=     	printf("Oper : %s\n", yytext);
-=     		printf("Oper : %s\n", yytext);
\*=     	printf("Oper : %s\n", yytext);
\/=     	printf("Oper : %s\n", yytext);
\/\/=    	printf("Oper : %s\n", yytext);
%=     		printf("Oper : %s\n", yytext);
@=     		printf("Oper : %s\n", yytext);
\&=     	printf("Oper : %s\n", yytext);
\|=     	printf("Oper : %s\n", yytext);
\^=     	printf("Oper : %s\n", yytext);
>>=     	printf("Oper : %s\n", yytext);
\<\<=   	printf("Oper : %s\n", yytext);
\*\*=     	printf("Oper : %s\n", yytext);
[0-9]*([0-9]\.|\.[0-9])[0-9]* printf("Float : %f\n", atof(yytext));
[0-9]+ 		printf("Number : %d\n", atoi(yytext));
[A-Za-z_][A-Za-z0-9_]*	printf("Identifier : %s\n", yytext);
%%
int main(int argc, char *argv[])
{
	yyin = fopen(argv[1], "r");
	yylex();
	return 0;
}